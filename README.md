# 基于大模型的多模态（情感、主题语义）谣言检测分析

这是一个为云计算课程设计的期末大作业项目。本项目旨在探索和实现一个结合了现代大语言模型（LLM）与传统机器学习方法的多模态框架，用于提升网络新闻的谣言检测（真/假新闻分类）性能。

## 📖 项目简介

本项目通过一个端到端的流程，系统性地解决了谣言检测问题：
1.  **环境搭建**：在本地macOS环境下，通过Ollama成功部署并运行了`deepseek-r1`大语言模型，为所有后续分析提供了强大的自然语言理解能力。
2.  **多模态特征工程**：我们从新闻文本中提取了两个核心维度的特征：
    * **情感语义特征**：利用LLM分析文本的情感色彩及其在不同提示词策略下的判断倾向。
    * **主题特征**：利用潜在狄利克雷分配（LDA）模型挖掘文本的潜在主题结构。
3.  **特征融合与建模**：采用早期融合策略，将“情感语义”与“主题”特征进行拼接，并输入多种分类模型（包括逻辑回归、随机森林、SVM和全连接网络）进行对比评估，以找到最优的预测模型。

## 🌟 核心发现

- **情感引导的重要性**：在第一部分实验中，通过在Prompt中加入情感引导，LLM的谣言检测准确率从60.0%显著提升至85.0%，证明了情感是识别假新闻（尤其是煽动性新闻）的关键线索。
- **特征工程的决定性作用**：在第三部分的综合模型对比中，一个有趣的发现是，结构最简单的**逻辑回归模型**（准确率89.5%）表现超越了更复杂的随机森林、SVM乃至全连接网络。这有力地证明了，当特征工程（即我们构建的多模态特征）足够成功时，其对最终结果的贡献要大于分类算法本身的选择。

## 🚀 如何运行

### **环境要求**

- Python 3.x (本项目在Anaconda环境中运行)
- Ollama及已下载的`deepseek-r1`模型
- 主要Python库: `pandas`, `gensim`, `scikit-learn`, `nltk`, `openai`, `tqdm`, `matplotlib`, `seaborn`, `wordcloud`, `pyLDAvis`, `openpyxl`

### **运行步骤**

1.  **准备数据**: 将原始的`Dataset.xlsx`文件放入`data/`文件夹中。

2.  **数据清洗与准备**: 运行脚本`1_data_preparation.py`来生成清洗后的数据子集。
    ```bash
    python 1_data_preparation.py
    ```

3.  **第一部分实验**: （可选）运行脚本`2_llm_sentiment_analysis.py`来复现第一部分LLM的对比分析。
    ```bash
    python 2_llm_sentiment_analysis.py
    ```

4.  **第二部分实验**: （可选）运行脚本`3_lda_topic_modeling.py`来复现第二部分LDA主题分析。
    ```bash
    python 3_lda_topic_modeling.py
    ```
    
5.  **第三部分实验**: 运行脚本`4_part3_multimodal_fusion.py`来复现最终的多模态融合与多模型对比分析。
    ```bash
    python 4_part3_multimodal_fusion.py
    ```

**注意**: 运行调用Ollama的脚本前，请确保Ollama服务正在本地运行。

---
